ОПИСАНИЕ ПРОЕКТА

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Постройте модель с предельно большим значением *F1*-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте *F1*-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте *AUC-ROC*, сравнивайте её значение с *F1*-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

ЧЕК-ЛИСТ ПРОЕКТА

- [x]  Jupyter Notebook открыт
- [x]  Весь код выполняется без ошибок
- [x]  Ячейки с кодом расположены в порядке исполнения
- [x]  Выполнен шаг 1: данные подготовлены
- [x]  Выполнен шаг 2: задача исследована
    - [x]  Исследован баланс классов
    - [x]  Изучены модели без учёта дисбаланса
    - [x]  Написаны выводы по результатам исследования
- [x]  Выполнен шаг 3: учтён дисбаланс
    - [x]  Применено несколько способов борьбы с дисбалансом
    - [x]  Написаны выводы по результатам исследования
- [x]  Выполнен шаг 4: проведено тестирование
- [x]  Удалось достичь *F1*-меры не менее 0.59
- [x]  Исследована метрика *AUC-ROC*

ЭТАПЫ ИССЛЕДОВАНИЯ

Изучен датасет, общий вывод:

Судя по предоставленным данным, мы видим несбалансированность почти во всех признаках.

Основные выводы:

- Клиентов, которые перестали пользоваться услугами банка в 4 раза меньше, чем тех, кто продолжает оставаться лояльным клиентом. Это целевой признак, существенный для исследования.

- Наличие кредитной карты, также несбалансированно - клиентов с кредитной картой в 2 раза меньше.

- Клиентов с 0 балансом на карте также достаточно много - более 3500. На гистограмме это выглядит как выброс - далее данные распределяются более-менее нормально.

- Клиентов среднего возраста 35-40 лет больше всего в датасете, тут также присутствует перекос.

- Клиентов из Франции больше всего - около 5 тыс.

Все это может повлиять на качество модели. При обучении это необходимо учесть и применить те методы, которые уменьшат несбалансированность данных.

Отобраны модели для тестирования:

Возьмем три основных модели обучения, подходящие для задач классификации, и рассмотрим на обучающей выборке, какая из них отработает лучше всего и с какими параметрами. ​ Для выбора оптимальных гиперпараметров воспользуемся GridSearchCV. Далее выберем самую эффективную модель и на ней поработаем с дисбалансом данных.

Общий вывод: Наилучшие результаты показала модель случайного леса. По метрике F1 наименьший результат у логистической регрессии, что было ожидаемо.
Для дальнейшей работы возьмем случайный лес и сравним с результатами логистической регрессии с применением нового параметра class_weight.

Борьба с дисбалансом:

Результаты удалось улучшить благодаря class_weight=balanced, который придает объектам редкого класса больший вес, и увеличению присутствия редкого класса в выборке.

Итог:

Модель случайного леса на тестовой выборке показала наилучшие результаты. По метрике F1 удалось добиться результат больше 0.59, сдвинув порог. По ROC-кривой мы также видим, что качество модели достаточно высокое, как и по метрике AUC-ROC.

Цель исследования удалось достичь.